<h1 align="center">ğŸ›¡ï¸ Telegram åŒå‘èŠå¤©æœºå™¨äºº</h1>

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.10+-blue.svg" alt="Python Version">
  <img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License">
  <a href="https://github.com/Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot/stargazers">
    <img src="https://img.shields.io/github/stars/Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot.svg?style=social&label=Star" alt="GitHub Stars">
  </a>
</p>

> ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€æ”¯æŒ AI é©±åŠ¨çš„ Telegram åŒå‘èŠå¤©æœºå™¨äººï¼Œä¸“ä¸ºæå‡ç”¨æˆ·ä¸ç®¡ç†å‘˜ä¹‹é—´çš„æ²Ÿé€šæ•ˆç‡å’Œå®‰å…¨æ€§è€Œè®¾è®¡ã€‚

<p align="center">
  <strong>å¦‚æœ‰ç–‘é—®è¯·è”ç³»: <a href="https://t.me/Sanite_Ava_Private_ChatBot">Sanite&Ava</a></strong>
</p>

---

## ğŸ“œ ç›®å½•

- [âœ¨ æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
- [ğŸš€ å¿«é€Ÿå¼€å§‹ (Docker æ¨è)](#-å¿«é€Ÿå¼€å§‹-docker-æ¨è)
- [ğŸ› ï¸ (å¯é€‰) æ‰‹åŠ¨éƒ¨ç½²](#ï¸-å¯é€‰-æ‰‹åŠ¨éƒ¨ç½²)
- [ğŸ“– ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—)
- [ğŸ”§ é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜)
- [ğŸ¤ è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)
- [ğŸ“„ è®¸å¯è¯](#-è®¸å¯è¯)

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | æè¿° |
| :--- | :--- |
| ğŸ’¬ **è¯é¢˜ç¾¤ç»„ç®¡ç†** | åˆ©ç”¨ Telegram Forum åŠŸèƒ½ï¼Œä¸ºæ¯ä½ç”¨æˆ·åˆ›å»ºç‹¬ç«‹å¯¹è¯çº¿ç¨‹ï¼Œè‡ªåŠ¨å±•ç¤ºç”¨æˆ·ä¿¡æ¯ï¼Œä¾¿äºæ¶ˆæ¯è¿½æº¯ä¸ç®¡ç†ã€‚ |
| ğŸ¤– **AI æ™ºèƒ½ç­›é€‰** | é›†æˆ Google Gemini APIï¼Œå¯æ™ºèƒ½è¯†åˆ«æ½œåœ¨çš„åƒåœ¾ä¿¡æ¯æˆ–æ¶æ„å†…å®¹ï¼Œå¹¶ç”¨äºç”Ÿæˆå¤šæ ·åŒ–çš„äººæœºéªŒè¯é—®é¢˜ã€‚ |
| ğŸ›¡ï¸ **äººæœºéªŒè¯ç³»ç»Ÿ** | æ–°ç”¨æˆ·é¦–æ¬¡äº¤äº’æ—¶éœ€é€šè¿‡ AI ç”Ÿæˆçš„éªŒè¯é—®é¢˜ï¼Œæœ‰æ•ˆæ‹¦æˆªè‡ªåŠ¨åŒ–æœºå™¨äººéªšæ‰°ã€‚ |
| âš¡ **é«˜æ€§èƒ½å¤„ç†** | åŸºäº `asyncio` çš„å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—å’Œå¤š Worker å¹¶è¡Œå¤„ç†æœºåˆ¶ï¼Œè½»æ¾åº”å¯¹é«˜å¹¶å‘åœºæ™¯ï¼Œæœç»æ¶ˆæ¯å µå¡ã€‚ |
| ğŸ–¼ï¸ **å¤šåª’ä½“æ”¯æŒ** | æ— ç¼è½¬å‘å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ã€æ–‡æ¡£ç­‰å¤šç§åª’ä½“æ ¼å¼ï¼Œå¹¶å®Œæ•´ä¿ç•™ Markdown æ ¼å¼ã€‚ |
| âš« **é»‘åå•ç®¡ç†** | ç®¡ç†å‘˜å¯è½»æ¾æ‹‰é»‘/è§£å°ç”¨æˆ·ã€‚è¢«æ‹‰é»‘ç”¨æˆ·å°†æ”¶åˆ°å‹å¥½æç¤ºï¼Œå¹¶å¯é€šè¿‡ AI ç”Ÿæˆçš„é—®ç­”æŒ‘æˆ˜è¿›è¡Œè‡ªåŠ©è§£å°ã€‚ |
| ğŸ” **æƒé™æ§åˆ¶** | åŸºäº Telegram ID çš„å¤šç®¡ç†å‘˜æƒé™ç³»ç»Ÿï¼Œç¡®ä¿åªæœ‰æˆæƒäººå‘˜æ‰èƒ½æ‰§è¡Œç®¡ç†æ“ä½œã€‚ |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Docker æ¨è)

> [!TIP]\
> æˆ‘ä»¬å¼ºçƒˆæ¨èä½¿ç”¨ Docker è¿›è¡Œéƒ¨ç½²ï¼Œè¿™å¯ä»¥ä¸ºæ‚¨å…å»ç¯å¢ƒé…ç½®çš„éº»çƒ¦ã€‚

1. é¦–å…ˆï¼Œåœ¨æ‚¨çš„æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œç”¨äºå­˜æ”¾æœºå™¨äººçš„é…ç½®å’Œæ•°æ®ã€‚

```bash
mkdir tg-bot-data
cd tg-bot-data
```

2. ä¸‹è½½ .env.example é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼Œå¹¶é‡å‘½åä¸º .env

```bash
# wget https://raw.githubusercontent.com/Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot/main/.env.example -O .env
```

3. ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„é…ç½®
```bash
nano .env
```

<details>
<summary>ğŸ“ ç‚¹å‡»æŸ¥çœ‹ .env æ–‡ä»¶é…ç½®ç¤ºä¾‹ (ç‚¹å‡»å±•å¼€)</summary>

åˆ›å»º `.env` æ–‡ä»¶åï¼Œæ‚¨å¯ä»¥å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶è¿›å»ï¼Œå¹¶æ ¹æ®æ³¨é‡Šä¿®æ”¹ä¸ºæ‚¨è‡ªå·±çš„é…ç½®ï¼š

```env
# --- å¿…éœ€é…ç½® ---

# Telegram Boté…ç½®
# ä» @BotFather è·å–æ‚¨çš„ Bot Token
BOT_TOKEN=your_bot_token_here

# æ‚¨çš„Telegramè¯é¢˜ç¾¤ç»„ID
# å°†æœºå™¨äººè®¾ä¸ºç¾¤ç»„ç®¡ç†å‘˜åï¼Œåœ¨ç¾¤ç»„é‡Œå‘é€ /getid ï¼Œæœºå™¨äººä¼šè‡ªåŠ¨å›å¤ç¾¤ç»„ID
FORUM_GROUP_ID=-1001234567890

# ç®¡ç†å‘˜IDï¼ˆæ‚¨çš„Telegramç”¨æˆ·IDï¼‰ï¼Œå¤šä¸ªIDç”¨é€—å·åˆ†éš”
ADMIN_IDS=123456789,987654321

# --- å¯é€‰é…ç½® ---

# Gemini APIé…ç½® (å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨AIç›¸å…³åŠŸèƒ½)
# ä» Google AI Studio è·å–
GEMINI_API_KEY=your_gemini_api_key_here

# æ˜¯å¦å¯ç”¨AIè‡ªåŠ¨è¯†åˆ«åƒåœ¾ä¿¡æ¯å’Œæ¶æ„å†…å®¹
ENABLE_AI_FILTER=true

# AIåˆ¤æ–­çš„ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆ0-100ï¼‰ï¼Œé«˜äºæ­¤å€¼æ‰ä¼šè¢«è®¤ä¸ºæ˜¯æ¶æ„å†…å®¹
AI_CONFIDENCE_THRESHOLD=70

# --- åŠŸèƒ½å¼€å…³ ---

# æ˜¯å¦å¯ç”¨æ–°ç”¨æˆ·äººæœºéªŒè¯
VERIFICATION_ENABLED=true

# æ˜¯å¦å¯ç”¨é»‘åå•ç”¨æˆ·è‡ªåŠ¨è§£å°æœºåˆ¶
AUTO_UNBLOCK_ENABLED=true

# --- æ•°æ®åº“é…ç½® ---
# å®¹å™¨å†…è·¯å¾„ï¼Œé€šå¸¸ä¸éœ€è¦ä¿®æ”¹
DATABASE_PATH=./data/bot.db

# --- æ€§èƒ½é…ç½® ---

# æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†çš„workeræ•°é‡
MAX_WORKERS=5

# é˜Ÿåˆ—ä¸­æ¶ˆæ¯çš„è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
QUEUE_TIMEOUT=30

# --- éªŒè¯é…ç½® ---

# äººæœºéªŒè¯çš„è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
VERIFICATION_TIMEOUT=300

# ç”¨æˆ·æœ€å¤§å°è¯•éªŒè¯æ¬¡æ•°
MAX_VERIFICATION_ATTEMPTS=3

# --- é€Ÿç‡é™åˆ¶ ---
# é€šå¸¸ä¸éœ€è¦ä¿®æ”¹

# Botæ¯ç§’æœ€å¤§å¤„ç†æ¶ˆæ¯æ•°
MAX_MESSAGES_PER_SECOND=30

# Botæ¯åˆ†é’Ÿåœ¨ç¾¤ç»„ä¸­æœ€å¤§å‘é€æ¶ˆæ¯æ•°
MAX_GROUP_MESSAGES_PER_MINUTE=20
```
</details>

--- 
> [!TIP]\
> é…ç½®å¥½ .env æ–‡ä»¶ï¼Œé€‰æ‹© Docker-compose / Docker éƒ¨ç½² Chatbot

### ä½¿ç”¨ Docker-Compose

1. ä¸‹è½½ docker-compose.yml:
```bash
wget https://raw.githubusercontent.com/Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot/main/docker-compose.yml
```

2. ä½¿ç”¨ Docker Compose è¿è¡Œ:
```bash
docker compose up -d
```

æ›´æ–°å®¹å™¨ï¼š
```bash
# åœ¨tg-bot-dataç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤
docker-compose down
docker-compose pull
docker-compose up -d
```

<details>
<summary>ğŸ“ ç‚¹å‡»æŸ¥çœ‹ã€Œé€šè¿‡ watchtower å®ç°è‡ªåŠ¨æ›´æ–°ã€(ç‚¹å‡»å±•å¼€)</summary>
# å°†ä¸‹åˆ—é…ç½®ã€Œè¦†ç›–ã€åˆ° docker-compose.yml ä¸­ï¼Œ
# ä½ å¯ä»¥é€šè¿‡ nano docker-compose.yml å‘½ä»¤è¿›è¡Œç¼–è¾‘

```bash
version: '3.8'

services:
  TG-Antiharassment-Bot:
    container_name: TG-Antiharassment-Bot
    image: weijiaqaq/tg-antiharassment-bot:latest
    restart: unless-stopped
    env_file:
     - .env
    volumes:
     - ./data:/app/data
  
  # watchtower é…ç½®
  watchtower:
    image: containrrr/watchtower
    container_name: watchtower
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    command: --cleanup --interval 3600 TG-Antiharassment-Bot 
    # TG-Antiharassment-Bot ä¸ºå®¹å™¨åï¼Œå¦‚æœæ˜¯è‡ªå®šä¹‰çš„ï¼Œè®°å¾—ä¿®æ”¹ã€‚
    # 3600 å•ä½ï¼ˆç§’ï¼‰
```
</details>

---
### ä½¿ç”¨ Docker Run

```bash
docker run -d \
  --name tg-antiharassment-bot \
  -v $(pwd)/.env:/app/.env \
  -v $(pwd)/data:/app/data \
  --restart unless-stopped \
  weijiaqaq/tg-antiharassment-bot:latest
```
> **å‘½ä»¤è§£æ:**
> - `-d`: åœ¨åå°è¿è¡Œå®¹å™¨ã€‚
> - `--name tg-antiharassment-bot`: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—ã€‚
> - `-v $(pwd)/.env:/app/.env`: å°†æ‚¨å½“å‰ç›®å½•ä¸‹çš„ `.env` æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚
> - `-v $(pwd)/data:/app/data`: å°†æ•°æ®ç›®å½•æŒ‚è½½å‡ºæ¥ï¼Œç¡®ä¿æŒä¹…åŒ–å­˜å‚¨ã€‚
> - `--restart unless-stopped`: å®¹å™¨é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯ï¼Œä¿è¯æœåŠ¡é«˜å¯ç”¨ã€‚
> - `weijiaqaq/tg-antiharassment-bot:latest`: æŒ‡å®šè¦è¿è¡Œçš„ Docker Hub é•œåƒã€‚

---

## ğŸ› ï¸ (å¯é€‰) æ‰‹åŠ¨éƒ¨ç½²

<details>
<summary>ğŸ‘¨â€ğŸ’» ç‚¹å‡»æŸ¥çœ‹ã€Œæ‰‹åŠ¨éƒ¨ç½²æŒ‡å—ã€ (ç‚¹å‡»å±•å¼€)</summary>

å¦‚æœæ‚¨ä¸æƒ³ä½¿ç”¨ Dockerï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨éƒ¨ç½²ã€‚

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot.git
cd Telegram_Anti-harassment_two-way_chatbot
```

#### 2. å®‰è£…ä¾èµ–

```bash
# å»ºè®®åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` æ–‡ä»¶ä¸º `.env`ï¼Œå¹¶å¡«å…¥æ‚¨çš„é…ç½®ã€‚è¯¦ç»†é…ç½®é¡¹è¯·å‚è€ƒ Docker éƒ¨ç½²éƒ¨åˆ†çš„ç¤ºä¾‹ã€‚

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘.envæ–‡ä»¶
nano .env
```

#### 4. è¿è¡ŒBot

```bash
python bot.py
```
</details>

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ğŸ”‘ è·å–å¿…è¦ä¿¡æ¯

1.  **Bot Token**: åœ¨ Telegram ä¸­ä¸ [@BotFather](https://t.me/BotFather) å¯¹è¯ï¼Œä½¿ç”¨ `/newbot` å‘½ä»¤åˆ›å»ºæœºå™¨äººå³å¯è·å¾—ã€‚
2.  **è¯é¢˜ç¾¤ç»„ ID**: åˆ›å»ºä¸€ä¸ªè¶…çº§ç¾¤ç»„ (Supergroup)ï¼Œåœ¨è®¾ç½®ä¸­å¯ç”¨â€œè¯é¢˜â€(Topics) åŠŸèƒ½ã€‚ç„¶åå°†æ‚¨çš„æœºå™¨äººæ·»åŠ ä¸ºè¯¥ç¾¤ç»„çš„ç®¡ç†å‘˜ã€‚åœ¨ç¾¤ç»„ä¸­å‘é€/getidï¼Œæœºå™¨äººä¼šè‡ªåŠ¨å›å¤åŒ…å«ç¾¤ç»„ ID çš„ä¿¡æ¯ã€‚
3.  **Gemini API å¯†é’¥** (å¯é€‰): è®¿é—® [Google AI Studio](https://aistudio.google.com/api-keys) åˆ›å»ºå¹¶å¤åˆ¶æ‚¨çš„ API å¯†é’¥ã€‚

### ğŸ“œ å‘½ä»¤åˆ—è¡¨

#### ç”¨æˆ·å‘½ä»¤
- `/start` - å¯åŠ¨æœºå™¨äººï¼Œæ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯ã€‚
- `/getid` - æ˜¾ç¤ºå½“å‰ç”¨æˆ·/ç¾¤ç»„IDã€‚
- `/help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚

#### ç®¡ç†å‘˜å‘½ä»¤
- `/block` - å¯¹åº”è¯é¢˜ç›´æ¥å‘é€æ°¸ä¹…æ‹‰é»‘ç”¨æˆ·ã€‚
- `/blacklist` - æŸ¥çœ‹å½“å‰çš„é»‘åå•åˆ—è¡¨ã€‚
- `/stats` - æŸ¥çœ‹æœºå™¨äººè¿è¡Œç»Ÿè®¡ä¿¡æ¯ã€‚

---

## ğŸ”§ é…ç½®è¯´æ˜

æ‰€æœ‰é…ç½®é¡¹å‡é€šè¿‡ `.env` æ–‡ä»¶è¿›è¡Œç®¡ç†ã€‚è¯¦ç»†çš„å˜é‡è¯´æ˜è¯·å‚è€ƒ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹-æ¨èä½¿ç”¨-docker) éƒ¨åˆ†çš„ `.env` æ–‡ä»¶ç¤ºä¾‹ã€‚

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼å¦‚æœæ‚¨æœ‰å¥½çš„æƒ³æ³•æˆ–å‘ç°äº† Bugï¼Œè¯·éšæ—¶æäº¤ Pull Request æˆ–åˆ›å»º Issueã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT è®¸å¯åè®®](LICENSE)ã€‚

## ğŸ™ è‡´è°¢

- [python-telegram-bot](https://github.com/python-telegram-bot/python-telegram-bot) - ä¼˜ç§€çš„ Telegram Bot æ¡†æ¶ã€‚
- [Google Gemini](https://ai.google.dev/) - æä¾›å¼ºå¤§çš„ AI èƒ½åŠ›ã€‚

---

<p align="center">
  å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Star â­ï¸
</p>
<p align="center">
  <a href="https://www.star-history.com/#Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot&type=date&legend=bottom-right">
    <img src="https://api.star-history.com/svg?repos=Hamster-Prime/Telegram_Anti-harassment_two-way_chatbot&type=date&legend=bottom-right" alt="Star History Chart">
  </a>
</p>